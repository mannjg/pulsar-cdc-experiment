# Minimal Pulsar configuration for local testing with functions and connectors
# This configuration reduces resource requirements while maintaining full functionality

# Use minimal replicas for all components
initialize: true

image:
  broker:
    repository: apachepulsar/pulsar
    tag: 3.3.9
  function:
    repository: apachepulsar/pulsar
    tag: 3.3.9

# Zookeeper configuration - minimal setup
zookeeper:
  replicaCount: 1
  resources:
    requests:
      memory: 128Mi
      cpu: 50m
  configData:
    PULSAR_MEM: "-Xms128m -Xmx256m"
    PULSAR_GC: "-XX:+UseG1GC"
  podMonitor:
    enabled: false

# BookKeeper configuration - minimal setup
bookkeeper:
  replicaCount: 1
  resources:
    requests:
      memory: 256Mi
      cpu: 50m
  configData:
    PULSAR_MEM: "-Xms256m -Xmx512m"
    PULSAR_GC: "-XX:+UseG1GC"
  podMonitor:
    enabled: false

# Broker configuration - minimal setup
broker:
  replicaCount: 1
  resources:
    requests:
      memory: 256Mi
      cpu: 50m
  configData:
    PULSAR_MEM: "-Xms256m -Xmx512m"
    PULSAR_GC: "-XX:+UseG1GC"
    managedLedgerDefaultEnsembleSize: "1"
    managedLedgerDefaultWriteQuorum: "1"
    managedLedgerDefaultAckQuorum: "1"
    functionsWorkerEnabled: "true"
  podMonitor:
    enabled: false

# Proxy configuration - minimal setup
proxy:
  replicaCount: 1
  resources:
    requests:
      memory: 128Mi
      cpu: 50m
  configData:
    PULSAR_MEM: "-Xms128m -Xmx256m"
    PULSAR_GC: "-XX:+UseG1GC"
  podMonitor:
    enabled: false

# Enable Pulsar Functions
functions:
  enabled: true
  functionReplicaCount: 1
  enableCustomizerRuntime: true
  resources:
    requests:
      memory: 256Mi
      cpu: 50m

# Disable monitoring components not needed for basic testing
pulsar_manager:
  enabled: false

grafana:
  enabled: false

prometheus:
  enabled: false

kube-prometheus-stack:
  enabled: false

# Disable all PodMonitor resources
monitoring:
  podMonitor:
    enabled: false

# Disable recovery PodMonitor
pulsar_metadata:
  component: pulsar-init
  podMonitor:
    enabled: false

# Volumes - use smaller sizes for testing
volumes:
  persistence: true
  journal:
    size: 5Gi
  ledgers:
    size: 10Gi
  useSingleCommonVolume: true
